<% layout('layout') -%>
<div class="row">
  <div class="col-sm-6 col-md-6">
    <h1>Your Shopping Cart</h1>
  </div>
  <div class="col-sm-6 col-md-6">
    <form name="input" action="pay" method="post">
      <input type="image" src="https://www.paypal.com/en_US/i/btn/btn_xpressCheckout.gif" value="submit" class="pull-right btn-next">
      </input>
  </form>
  </div>
</div>
<div class="row">
  <div class="table-responsive">
    <table class="table table-hover table-bordered">
      <thead>
        <tr>
          <th>Product</th>
          <th>Unit Price</th>
          <th>Quantity</th>
          <th>Total Product Price</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% for (var i=0; i<cart.length; i++) {
            var product = cart[i]; %>
        <tr>
          <td>
            <%- utils.link_to('/product/' + product.product_id,
                utils.responsiveImage(
                  S3URL+'/'+product.variant.key,
                  'Picture of '+product.variant.name+' of '+product.name))
            %><%- utils.link_to('/product/' + product.product_id,
                                product.variant.name +' of ' + product.name) %>
            <br>by <%- utils.link_to('/brands/' + product.brand_name,
                                     product.brand_name) %>
          </td>
          <td><%= product.variant.price %> $</td>
          <td><%= product.quantity %></td>
          <td><%= product.variant.price * product.quantity %> $</td>
          <td><button class="btn btn-danger btn-sm">Remove</button></td>
        </tr>
        <% } %>
        <tr>
          <td colspan="3" class="td-right"><h4>Total Items Price</h4></td>
          <td><%- cart.reduce(function sumPrice (prev, curr, ind, arr) {
            return prev + curr.variant.price * curr.quantity;
            }, 0) %> $
        </tr>
        <tr>
          <td colspan="3" class="td-right">
            <h4>Estimated Shipping (EMS)</h4>
          </td>
          <td>
            <select name="shippingCost" id="shippingCost">
              <option value="30">US: 30$</option>
              <option value="40">Europe: 40$</option>
              <option value="35">Asia: 35$</option>
            </select>
          </td>
        </tr>
        <tr>
          <td colspan="3" class="td-right">
            <h4>Estimated Order Total</h4>
          </td>
          <td>
            <h4><%- cart.reduce(function sumPrice (prev, curr, ind, arr) {
            return prev + curr.variant.price * curr.quantity;
            }, 0) + 30 %> $</h4>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <!-- <button class="btn btn-next pull-right">>> Checkout with Paypal</button> -->
  <form name="input" action="pay" method="post">
    <input type="image" src="https://www.paypal.com/en_US/i/btn/btn_xpressCheckout.gif" value="submit" class="pull-right btn-next">
    </input>
  </form>
</div>